
CREATE TABLE calc_user (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   user_name VARCHAR(255) NOT NULL,
   name VARCHAR(255) NOT NULL,
   password VARCHAR(255),
   status VARCHAR(255) NOT NULL,
   balance DOUBLE PRECISION NOT NULL,
   CONSTRAINT pk_user PRIMARY KEY (id)
);

ALTER TABLE calc_user ADD CONSTRAINT uc_user_username UNIQUE (user_name);

CREATE TABLE user_record (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   operation_id BIGINT NOT NULL,
   user_id BIGINT NOT NULL,
   amount DOUBLE PRECISION NOT NULL,
   user_balance DOUBLE PRECISION NOT NULL,
   operation_response VARCHAR(255) NOT NULL,
   record_date date NOT NULL,
   CONSTRAINT pk_userrecord PRIMARY KEY (id)
);

ALTER TABLE user_record ADD CONSTRAINT FK_USERRECORD_ON_OPERATION FOREIGN KEY (operation_id) REFERENCES operation (id);

ALTER TABLE user_record ADD CONSTRAINT FK_USERRECORD_ON_CALC_USER FOREIGN KEY (user_id) REFERENCES calc_user (id);

CREATE TABLE operation (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
   type VARCHAR(255),
   cost DOUBLE PRECISION,
   user_id BIGINT NOT NULL,
   CONSTRAINT pk_operation PRIMARY KEY (id)
);

ALTER TABLE operation ADD CONSTRAINT FK_OPERATION_ON_CALC_USER FOREIGN KEY (user_id) REFERENCES calc_user (id);












